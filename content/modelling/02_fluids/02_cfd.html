
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.2. Вычислительная гидродинамика &#8212; Fire Simulation &lt;br&gt; Lecture Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=ed0cee17" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"vv": "\\vec{v}", "vu": "\\vec{u}", "mf": "\\small\\sf", "dQ": "\\dot{Q}", "dq": "\\dot{q}", "dm": "\\dot{m}", "du": "\\dot{u}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/modelling/02_fluids/02_cfd';</script>
    <link rel="canonical" href="https://firedynamics.github.io/LectureFireSimulation/content/modelling/02_fluids/02_cfd.html" />
    <link rel="icon" href="../../../_static/cce_logo_standalone_icon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.3. Turbulence" href="03_turbulence.html" />
    <link rel="prev" title="2.1. Жидкости и газы" href="01_fluids.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../overview/01_overview.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/cce_logo.png" class="logo__image only-light" alt="Fire Simulation <br> Lecture Notes - Home"/>
    <script>document.write(`<img src="../../../_static/cce_logo.png" class="logo__image only-dark" alt="Fire Simulation <br> Lecture Notes - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../overview/01_overview.html">
                    Обзор
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview/02_team.html">Team Fire Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/03_references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelling</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01_general/00_overview.html">1. Моделирование пожаров</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01_general/01_processes.html">1.1. Физические и химические процессы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_general/02_fse.html">1.2. Проектирование пожарной безопасности</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_general/03_approaches.html">1.3. Подходы к моделированию</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="00_overview.html">2. Гидродинамика</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_fluids.html">2.1. Жидкости и газы</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.2. Вычислительная гидродинамика</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_turbulence.html">2.3. Turbulence</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_compartments/00_overview.html">3. Compartment Fires</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_compartments/01_fundamentals.html">3.1. Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_compartments/03_pool_example.html">3.2. Example – Pool Fire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_compartments/04_steckler_example.html">3.3. Example - Steckler Compartment</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_thermodynamics/00_overview.html">4. Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_thermodynamics/01_fundamentals.html">4.1. Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_thermodynamics/02_example_energy_mass_transfer.html">4.2. Energy and Mass Transfer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05_combustion/00_overview.html">5. Combustion</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05_combustion/01_fundamentals.html">5.1. Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_combustion/02_modelling.html">5.2. Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_combustion/03_closed_volume_example.html">5.3. Example – Closed Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_combustion/04_burner_example.html">5.4. Wolfhard-Parker Burner</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06_heat_transfer/00_overview.html">6. Heat Transfer</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06_heat_transfer/01_fundamentals.html">6.1. Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_heat_transfer/02_heat_transfer_example.html">6.2. Example – Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_heat_transfer/03_validation_example.html">6.3. Validation – Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_heat_transfer/04_ht3d_example.html">6.4. Example – 3D Heat Transfer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07_particles/00_overview.html">7. Particles</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../07_particles/01_fundamentals.html">7.1. Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_particles/02_example_spray.html">7.2. Example – Sprays</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../09_pyrolysis/00_overview.html">8. Pyrolysis</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../09_pyrolysis/01_fundamentals.html">8.1. Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_pyrolysis/02_example.html">8.2. Example - Gasification of PMMA</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/01_basic/00_overview.html">Basic</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_basic/01_basic_example_i.html">Basic FDS Example I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_basic/02_basic_example_ii.html">Basic FDS Example II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_basic/03_basic_example_iii.html">Basic Example III</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_basic/04_basic_example_iv.html">Basic Example IV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_basic/05_basic_example_v.html">Basic Example V</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/02_intermediate/00_overview.html">Intermediate</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/01_data_analysis_01.html">Data Analysis I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/02_adjust_fds_input.html">Adjust FDS Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/03_work_flow.html">Work Flow Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/04_repeated_sim_exec.html">Repetitive Execution of Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/05_data_analysis_02.html">Data Analysis II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_intermediate/06_build_fds_input.html">Build FDS Input Lines Using Python String Manipulation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/03_advanced/00_overview.html">Advanced</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/03_advanced/McCaffrey.html">McCaffrey Plumes</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../examples/03_advanced/02_example_stecklercompartments.html">Steckler Compartments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/03_advanced/03_example_zukoskiplumes.html">Zukoski Plumes</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tools/01_fds_smv/00_overview.html">FDS and SMV</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/01_fds_smv/01_fds_intro.html">FDS Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/01_fds_smv/02_fds_tutorial.html">FDS Basic Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/01_fds_smv/03_smv.html">Smokeview Basics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tools/02_hpc/00_overview.html">HPC</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/02_hpc/01_linux.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/02_hpc/02_hpc.html">High Performance Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/02_hpc/03_parallel_fds.html">Parallel Execution of FDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/02_hpc/04_benchmarking.html">Benchmarking</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tools/03_analysis/00_overview.html">Data Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/03_analysis/01_python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/03_analysis/03_example_mccaffreyplumes.html">Example: McCaffrey plume experiments</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../tools/03_analysis/02_fdsreader.html">fdsreader Module</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teaching</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../teaching/01_firesim_lecture/00_overview.html">Fire Simulation Lecture @ BUW</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../teaching/01_firesim_lecture/01_week_01.html">Week 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../teaching/01_firesim_lecture/02_week_02.html">Week 2</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../teaching/02_cobra_workshop/00_overview.html">CoBra Workshop</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../teaching/02_cobra_workshop/01_ws_01.html">CoBra Workshop I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../teaching/02_cobra_workshop/02_ws_01.html">CoBra Workshop II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../teaching/02_cobra_workshop/03_ws_01.html">CoBra Workshop III</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://io.cce.uni-wuppertal.de/firesim_ss21/hub/user-redirect/git-pull?repo=https%3A//github.com/FireDynamics/LectureFireSimulation&urlpath=tree/LectureFireSimulation/book/content/modelling/02_fluids/02_cfd.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FireDynamics/LectureFireSimulation" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FireDynamics/LectureFireSimulation/edit/main/book/content/modelling/02_fluids/02_cfd.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FireDynamics/LectureFireSimulation/issues/new?title=Issue%20on%20page%20%2Fcontent/modelling/02_fluids/02_cfd.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/modelling/02_fluids/02_cfd.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Вычислительная гидродинамика</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Обзор</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Аппроксимация производных</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Ряд Тейлора</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Производные</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Дискретизация</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Дискретные производные</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Ошибка аппроксимации</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Интегрирование по времени</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Траектории</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Явный метод Эйлера</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Неявный метод Эйлера</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Метод Эйлера-Хойна</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Методы Рунге-Кутты</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Метод конечных разностей</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Подход к решению</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Устойчивость</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Распространение информации</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cfl">Условие Куранта-Фридрихса-Леви (CFL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Дополнительная заметка о том, как выполнялись вычисления в прошлом</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_hide_cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Установите вывод matplotlib в формат svg</span>
<span class="c1"># из IPython.display импортируйте set_matplotlib_formats</span>
<span class="c1"># set_matplotlib_formats(&#39;svg&#39;)</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># проверьте, установлена ли переменная среды JB_NOSHOW</span>
<span class="n">show</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="s1">&#39;JB_NOSHOW&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="n">show</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</details>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">2.2. </span>Вычислительная гидродинамика<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="id2">
<h2>Обзор<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Самый общий подход к численному решению набора связанных PDE описан на Fig. 2.11. В случае гидродинамики это уравнения, введенные ранее. Численное решение этих задач называется вычислительной гидродинамикой (CFD).</p>
<figure class="align-default" id="fig-cfd-overview">
<a class="reference internal image-reference" href="../../../_images/numerical_solution_overview.svg"><img alt="../../../_images/numerical_solution_overview.svg" src="../../../_images/numerical_solution_overview.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.11 </span><span class="caption-text">Обзор общего подхода в вычислительной гидродинамике.</span><a class="headerlink" href="#fig-cfd-overview" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Основным аспектом решения PDE является аппроксимация производных. Эта аппроксимация выполняется в дискретизированной области и приводит к набору алгебраических уравнений, в конечном счете к системе линейных уравнений. Существует множество подходов к аппроксимации с различными особенностями и свойствами, среди которых наиболее заметными являются три:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method">Метод конечных элементов (МКЭ)</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Finite_volume_method">Метод конечных объемов (FVM)</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">Метод конечных разностей (FDM)</a></p></li>
</ul>
<p>Поскольку FDS является решателем на основе FDM, основное внимание в этом разделе уделяется методу конечных разностей. Тем не менее, будет также рассмотрено несколько отдельных аспектов FVM.</p>
</section>
<section id="id3">
<h2>Аппроксимация производных<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>Ряд Тейлора<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Taylor_series">Ряд Тейлора</a> может аппроксимировать любую <span class="math notranslate nohighlight">\(\mf C^\infty\)</span> функция в точке разложения <span class="math notranslate nohighlight">\(\mf x_0\)</span>. Аппроксимация f <span class="math notranslate nohighlight">\(\mf f(x)\)</span> изложена в терминах <span class="math notranslate nohighlight">\(\mf h\)</span>,являющейся переменной координатой в окрестности  <span class="math notranslate nohighlight">\(\mf x_0\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-taylor-series">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-eq-taylor-series" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align}
\mf f(x_0 + h) &amp;=\mf \sum_{i=0}^{\infty}\frac{1}{i!}\left.\frac{d^if}{dx^i}\right|_{x_0}\cdot h^i \\ 
\mf &amp;=\mf f(x_0) + f'(x_0)\cdot h + \frac{1}{2} f''(x_0)\cdot h^2 + \frac{1}{6}f'''(x_0)\cdot h^3 + \cdots
\end{align}
\end{split}\]</div>
<aside class="margin sidebar">
<p class="sidebar-title">Big O нотация</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Big_O_notation">Big O нотация</a> <span class="math notranslate nohighlight">\(\mf \mathcal{O}\)</span> указывает на асимптотическое поведение функции. При аппроксимации производных, показанной в этом разделе, она указывает на функциональное уменьшение ошибки аппроксимации для <span class="math notranslate nohighlight">\(\mf h \rightarrow 0\)</span>.</p>
</aside>
<p>На практике расширение прерывается в заданном порядке <span class="math notranslate nohighlight">\(\mf \mathcal{O}(h^n)\)</span>,где <span class="math notranslate nohighlight">\(\mf n\)</span> обозначает количество рассматриваемых членов Тейлора, т.е.</p>
<div class="math notranslate nohighlight" id="equation-eq-taylor-series-n">
<span class="eqno">(2.12)<a class="headerlink" href="#equation-eq-taylor-series-n" title="Link to this equation">#</a></span>\[
\mf f(x_0 + h) =\sum_{i=0}^{n-1}\left(\frac{1}{i!}\left.\frac{d^if}{dx^i}\right|_{x_0}\cdot h^i\right) +  \mathcal{O}(h^n)\quad .
\]</div>
<p>Разложение до третьего порядка <span class="math notranslate nohighlight">\(\mf \mathcal{O}(h^3)\)</span> принимает следующий вид</p>
<div class="math notranslate nohighlight" id="equation-eq-taylor-3rd">
<span class="eqno">(2.13)<a class="headerlink" href="#equation-eq-taylor-3rd" title="Link to this equation">#</a></span>\[
\mf f(x_0 + h) = f(x_0) + f'(x_0)\cdot h + \frac{1}{2} f''(x_0)\cdot h^2 + \mathcal{O}(h^3)\quad .
\]</div>
<p><strong>Пример разложения ряда Тейлора</strong></p>
<p>В качестве примера приведена аппроксимация функции</p>
<div class="math notranslate nohighlight" id="equation-eq-cfd-example-fnk">
<span class="eqno">(2.14)<a class="headerlink" href="#equation-eq-cfd-example-fnk" title="Link to this equation">#</a></span>\[
\mf f(x) = \frac{x}{10} + \frac{1}{1+x^2}
\]</div>
<p>в точке оценивания <span class="math notranslate nohighlight">\(\mf x_0 = 2.0\)</span>.</p>
<div class="cell tag_hide_cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># определение функции примера и ее аналитических производных</span>
<span class="k">def</span> <span class="nf">fnk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">derivative</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">derivative</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">derivative</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">derivative</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide_cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># установите интервал для x</span>
<span class="n">xb</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">xe</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># диапазон значений x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># точка оценивания</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="c1"># производные значения при x0</span>
<span class="n">f0p0</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">f0p1</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f0p2</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f0p3</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># ряды Тейлора для различных порядков</span>
<span class="n">ts0</span> <span class="o">=</span>             <span class="n">f0p0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">0</span>
<span class="n">ts1</span> <span class="o">=</span> <span class="n">ts0</span> <span class="o">+</span>       <span class="n">f0p1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">1</span>
<span class="n">ts2</span> <span class="o">=</span> <span class="n">ts1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f0p2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ts3</span> <span class="o">=</span> <span class="n">ts2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">f0p3</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

<span class="c1"># построение графика</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_fnk.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^0)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_ts0.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^1)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_ts1.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^2)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_ts2.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^3)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_ts3.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^0)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^1)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^2)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ts3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{O}</span><span class="s1">(h^3)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/taylor_all.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/52cf42e2f8dca9b480b7fb3f7117757ce8fa735dcff656eb41cf9c3e6ed18b83.svg" src="../../../_images/52cf42e2f8dca9b480b7fb3f7117757ce8fa735dcff656eb41cf9c3e6ed18b83.svg" /><img alt="../../../_images/7c668e97c5c541c5aa0a647a627b73e2460aaf649fb5bcaac99201635269aab0.svg" src="../../../_images/7c668e97c5c541c5aa0a647a627b73e2460aaf649fb5bcaac99201635269aab0.svg" /><img alt="../../../_images/adfc60c9d07373e3e39e5d507a62b151423f74ee8c5fef82492a00ef2502ffe4.svg" src="../../../_images/adfc60c9d07373e3e39e5d507a62b151423f74ee8c5fef82492a00ef2502ffe4.svg" /><img alt="../../../_images/ff903717cb9f8dcfc2afe16be591a814c3389f5c440043b1d617678119e2cd2c.svg" src="../../../_images/ff903717cb9f8dcfc2afe16be591a814c3389f5c440043b1d617678119e2cd2c.svg" /><img alt="../../../_images/3086d0c58f23de97eb7b85b206b467a6d61f31106f8a1670ee1645b4b2a864e5.svg" src="../../../_images/3086d0c58f23de97eb7b85b206b467a6d61f31106f8a1670ee1645b4b2a864e5.svg" /><img alt="../../../_images/aae72d83c45bf33336111ab84eee26cde803ab7bd0dee03e131113b1aedb3949.svg" src="../../../_images/aae72d83c45bf33336111ab84eee26cde803ab7bd0dee03e131113b1aedb3949.svg" /><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</details>
</div>
<p>Следующие рисунки иллюстрируют соответствующие аппроксимации Тейлора для <span class="math notranslate nohighlight">\(\mf n=3\)</span>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
f(x)</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_fnk.svg" width="90%">
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
n=0</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_ts0.svg" width="90%">
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
n=1</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_ts1.svg" width="90%">
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-3">
n=2</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_ts2.svg" width="90%">
</div>
<input id="sd-tab-item-4" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
n=3</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_ts3.svg" width="90%">
</div>
<input id="sd-tab-item-5" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-5">
n in [0,…,3]</label><div class="sd-tab-content docutils">
<img src="./figs/taylor_all.svg" width="90%">
</div>
</div>
</section>
<section id="id5">
<h3>Производные<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Для аппроксимации первой производной функции <span class="math notranslate nohighlight">\(\mf f(x)\)</span> на <span class="math notranslate nohighlight">\(\mf x=x_0\)</span>, т.е. <span class="math notranslate nohighlight">\(\mf f'(x_0)\)</span>, разложение Тейлора вплоть до <span class="math notranslate nohighlight">\(\mf n=2\)</span> могут быть использованы</p>
<div class="math notranslate nohighlight" id="equation-eq-fdm-taylor-n2">
<span class="eqno">(2.15)<a class="headerlink" href="#equation-eq-fdm-taylor-n2" title="Link to this equation">#</a></span>\[
\mf f(x_0 + h) = f(x_0) + f'(x_0)h + \mathcal{O}(h^2)\quad .
\]</div>
<p>После перестановки это приводит к прямому дифференцированию первого порядка</p>
<div class="math notranslate nohighlight" id="equation-eq-fdm-fwd-frst">
<span class="eqno">(2.16)<a class="headerlink" href="#equation-eq-fdm-fwd-frst" title="Link to this equation">#</a></span>\[
\mf f'(x_0) = \frac{f(x_0 + h) - f(x_0)}{h} + \mathcal{O}(h)\quad .
\]</div>
<p>Таким образом, с помощью этой формулы можно приближенно определить значение производной по двум значениям функции, в <span class="math notranslate nohighlight">\(\mf x_0\)</span> и <span class="math notranslate nohighlight">\(\mf x_0 + h\)</span>.</p>
<p>Графическое представление уравнения <a class="reference internal" href="#equation-eq-fdm-fwd-frst">(2.16)</a> показано ниже. Оно демонстрирует формулу для <span class="math notranslate nohighlight">\(\mf h=1\)</span>.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># зафиксировать значение h</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># вычислить точную касательную функцию при x0</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">f0p0</span> <span class="o">+</span> <span class="n">f0p1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>

<span class="c1"># значение функции при x0+h</span>
<span class="n">f_ph</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># вычислить разницу в значениях функций</span>
<span class="c1"># f0p0 - это значение функции (p0) при x0 (f0)</span>
<span class="n">df_fwd</span> <span class="o">=</span> <span class="n">f_ph</span> <span class="o">-</span> <span class="n">f0p0</span>

<span class="c1"># вычислить линию в точке (x0, f0) с приблизительным наклоном</span>
<span class="n">fp_fwd</span> <span class="o">=</span> <span class="n">f0p0</span> <span class="o">+</span> <span class="n">df_fwd</span><span class="o">/</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>

<span class="c1"># функция построения графика f(x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sf f(x)$&#39;</span><span class="p">)</span>

<span class="c1"># построить касательную к f(x) в точке x0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># постройте линию в точке x0, f(x0) с наклоном, вычисленным по прямой разности</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_fwd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;forward difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># указать точки оценки функции</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">],</span> <span class="p">[</span><span class="n">f0p0</span><span class="p">,</span> <span class="n">f_ph</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/derivative_forward.svg&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0c4433d6ce261633d161752f6b7cdca46d1f26f13ccedc0cb67f9216f87ff4fd.svg" src="../../../_images/0c4433d6ce261633d161752f6b7cdca46d1f26f13ccedc0cb67f9216f87ff4fd.svg" /></div>
</details>
</div>
<figure class="align-default" id="fig-fwd-difference">
<a class="reference internal image-reference" href="../../../_images/derivative_forward.svg"><img alt="../../../_images/derivative_forward.svg" src="../../../_images/derivative_forward.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.12 </span><span class="caption-text">Формула прямой разности первого порядка</span><a class="headerlink" href="#fig-fwd-difference" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Хотя в приведенной выше формуле использовалось значение при <span class="math notranslate nohighlight">\(\mf x_0 + h\)</span> и, таким образом, называется формулой прямых различий, значение функции можно использовать при <span class="math notranslate nohighlight">\(\mf x_0 - h\)</span>. Это приводит к формуле обратных различий</p>
<div class="math notranslate nohighlight" id="equation-eq-fdm-backward-frst">
<span class="eqno">(2.17)<a class="headerlink" href="#equation-eq-fdm-backward-frst" title="Link to this equation">#</a></span>\[
\mf f'(x_0) = \frac{f(x_0) - f(x_0 - h)}{h} + \mathcal{O}(h)\quad .
\]</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># значение функции при x0-h</span>
<span class="n">f_nh</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># вычислить разницу в значениях функций</span>
<span class="c1"># f0p0 - это значение функции (p0) при x0 (f0)</span>
<span class="n">df_bck</span> <span class="o">=</span> <span class="n">f0p0</span> <span class="o">-</span> <span class="n">f_nh</span> 

<span class="c1"># вычислить линию в точке (x0, f0) с приблизительным наклоном</span>
<span class="n">fp_bck</span> <span class="o">=</span> <span class="n">f0p0</span> <span class="o">+</span> <span class="n">df_bck</span><span class="o">/</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>

<span class="c1"># функция построения графика f(x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sf f(x)$&#39;</span><span class="p">)</span>

<span class="c1"># построить касательную к f(x) в точке x0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># построить линию в x0, f(x0) с наклоном, вычисленным по обратной разности</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_bck</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;backward difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># указать точки оценки функции</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="o">-</span><span class="n">h</span><span class="p">],</span> <span class="p">[</span><span class="n">f0p0</span><span class="p">,</span> <span class="n">f_nh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/derivative_backward.svg&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c5bd443b44ec5d8d8ddc41f5dd08fd2549ad5c9de1b0db44fb103bd93f9f8cdf.svg" src="../../../_images/c5bd443b44ec5d8d8ddc41f5dd08fd2549ad5c9de1b0db44fb103bd93f9f8cdf.svg" /></div>
</details>
</div>
<figure class="align-default" id="fig-bck-difference">
<a class="reference internal image-reference" href="../../../_images/derivative_backward.svg"><img alt="../../../_images/derivative_backward.svg" src="../../../_images/derivative_backward.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.13 </span><span class="caption-text">Формула обратной разности первого порядка.</span><a class="headerlink" href="#fig-bck-difference" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Приближений первого порядка в большинстве случаев недостаточно, и необходимы приближения более высокого порядка. Используя большее количество значений функции, т. е. комбинацию нескольких рядов Тейлора, можно вывести формулу более высокого порядка, например, для формулы центральных различий второго порядка.</p>
<p>В качестве отправной точки используются следующие два ряда Тейлора</p>
<div class="math notranslate nohighlight" id="equation-eq-fdm-central-start">
<span class="eqno">(2.18)<a class="headerlink" href="#equation-eq-fdm-central-start" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align} 
\mf f(x_0+h) &amp;\mf= f(x_0) + f'(x_0)\cdot h + \frac{1}{2}f''(x_0)\cdot h^2 + \mathcal{O}(h^3) \\ 
\mf f(x_0-h) &amp;\mf= f(x_0) - f'(x_0)\cdot h + \frac{1}{2}f''(x_0)\cdot h^2 + \mathcal{O}(h^3) 
\end{align}
\end{split}\]</div>
<p>Вычитание первого уравнения из второго</p>
<div class="math notranslate nohighlight" id="equation-eq-fdm-central-intermediate">
<span class="eqno">(2.19)<a class="headerlink" href="#equation-eq-fdm-central-intermediate" title="Link to this equation">#</a></span>\[
\mf f(x_0+h) - f(x_0-h) = 2f'(x_0)\cdot h + \mathcal{O}(h^3)
\]</div>
<p>результаты в формуле центральной разности для первой производной
$<span class="math notranslate nohighlight">\(
\mf f'(x_0) = \frac{f(x_0+h) - f(x_0-h)}{2h} + \mathcal{O}(h^2)\quad .
\)</span>$ (eq-cfd-central-derivative-snd)</p>
<p>Формула центральных различий графически представлена на следующем рисунке.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># вычислить разницу в значениях функций</span>
<span class="c1"># f0p0 - это значение функции (p0) при x0 (f0)</span>
<span class="n">df_cnt</span> <span class="o">=</span> <span class="n">f_ph</span> <span class="o">-</span> <span class="n">f_nh</span>

<span class="c1"># вычислить линию в точке (x0, f0) с приблизительным наклоном</span>
<span class="n">fp_cnt</span> <span class="o">=</span> <span class="n">f0p0</span> <span class="o">+</span> <span class="n">df_cnt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>
<span class="c1"># вычислить линию в точке (x0+h, f(x0+h)) с приблизительным наклоном для иллюстрации</span>
<span class="n">fp_cnt_tmp</span> <span class="o">=</span> <span class="n">f_ph</span> <span class="o">+</span> <span class="n">df_cnt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="o">-</span><span class="n">h</span><span class="p">)</span>

<span class="c1"># функция построения графика f(x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sf f(x)$&#39;</span><span class="p">)</span>

<span class="c1"># построить касательную к f(x) в точке x0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># постройте линию в точке x0, f(x0) с наклоном, вычисленным по центральной разности</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_cnt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;central difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_cnt_tmp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># указать точки оценки функции</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">],</span> <span class="p">[</span><span class="n">f_nh</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">f_ph</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/derivative_central.svg&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3e40cdd49c1d6f8a88f9843d0dbb3b37e1a8e50b101054e88cfc546e2f3c37bb.svg" src="../../../_images/3e40cdd49c1d6f8a88f9843d0dbb3b37e1a8e50b101054e88cfc546e2f3c37bb.svg" /></div>
</details>
</div>
<figure class="align-default" id="fig-cnt-difference">
<a class="reference internal image-reference" href="../../../_images/derivative_central.svg"><img alt="../../../_images/derivative_central.svg" src="../../../_images/derivative_central.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.14 </span><span class="caption-text">Формула центральной разности второго порядка.</span><a class="headerlink" href="#fig-cnt-difference" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Все три представленных метода показаны на совместной иллюстрации на следующем рисунке.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># функция построения графика f(x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sf f(x)$&#39;</span><span class="p">)</span>

<span class="c1"># построить касательную к f(x) в точке x0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>

<span class="c1"># линии, указывающие приближения наклона</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_fwd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;forward difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_bck</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;backward difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_cnt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;central difference $\sf f&#39;(x_0)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp_cnt_tmp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># указать точки оценки функции</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">],</span> <span class="p">[</span><span class="n">f_nh</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">f_ph</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f0p0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/derivative_all.svg&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/2678d79002601201b4a2076a950c093796d978121a58296d1c14704e8351a40d.svg" src="../../../_images/2678d79002601201b4a2076a950c093796d978121a58296d1c14704e8351a40d.svg" /></div>
</details>
</div>
<figure class="align-default" id="fig-all-difference">
<a class="reference internal image-reference" href="../../../_images/derivative_all.svg"><img alt="../../../_images/derivative_all.svg" src="../../../_images/derivative_all.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.15 </span><span class="caption-text">Сравнение всех приведенных выше разностных формул.</span><a class="headerlink" href="#fig-all-difference" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Также возможно вывести формулы направления (прямого, обратного) второго порядка. Вычисление приводит к следующим формулам</p>
<div class="math notranslate nohighlight" id="equation-eq-cfd-directional-derivative-snd">
<span class="eqno">(2.20)<a class="headerlink" href="#equation-eq-cfd-directional-derivative-snd" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align}
\mf f'(x_0) &amp;\mf= \frac{-3f(x_0) + 4f(x_0+h) - f(x_0+2h)}{2h} + \mathcal{O}(h^2) \\
\mf f'(x_0) &amp;\mf= \frac{ 3f(x_0) - 4f(x_0-h) + f(x_0-2h)}{2h} + \mathcal{O}(h^2) \quad .
\end{align}
\end{split}\]</div>
<div class="admonition- admonition">
<p class="admonition-title">Задание</p>
<p>Выведите формулу дискретизации для второй производной</p>
<div class="math notranslate nohighlight" id="equation-eq-cfd-central-sndderivative-snd">
<span class="eqno">(2.21)<a class="headerlink" href="#equation-eq-cfd-central-sndderivative-snd" title="Link to this equation">#</a></span>\[
\mf f''(x_0) = \frac{f(x_0-h) - 2f(x_0) + f(x_0+h)}{h^2} + \mathcal{O}(h^2)
\]</div>
</div>
</section>
<section id="id6">
<h3>Дискретизация<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>В приведенном выше разделе производная функции была аппроксимирована в одной точке, здесь <span class="math notranslate nohighlight">\(\mf x_0\)</span>. Для того, чтобы вычислить производную функции в заданном интервале <span class="math notranslate nohighlight">\(\mf x \in [x_b, x_e]\)</span>, общий подход заключается в дискретизации интервала. Это означает, что он представлен конечным числом точек. Учитывая <span class="math notranslate nohighlight">\(\mf n_x\)</span> по мере увеличения количества представляющих точек интервал становится следующим конечным множеством:</p>
<div class="math notranslate nohighlight">
\[
\mf x \in [x_0, \dots, x_i, \dots, x_{n_x-1}]
\]</div>
<p>с</p>
<div class="math notranslate nohighlight">
\[ 
\mf x_0 = x_b; \quad x_{n_x-1} = x_e
\]</div>
<p>Если представленные точки расположены на равном расстоянии друг от друга, то расстояние <span class="math notranslate nohighlight">\(\mf \Delta x\)</span> является</p>
<div class="math notranslate nohighlight">
\[
\mf \Delta x = \frac{x_e - x_b}{n_x-1}\quad
\]</div>
<p>и значение <span class="math notranslate nohighlight">\(\mf x_i\)</span> определяется следующим образом</p>
<div class="math notranslate nohighlight">
\[
\mf x_i = x_b + i\cdot \Delta x \quad .
\]</div>
<p>В двух- и трехмерных случаях эта дискретизация может быть представлена в виде сетки, см. <a class="reference internal" href="../01_general/03_approaches.html#fig-field-model"><span class="std std-numref">Fig. 1.19</span></a>. Таким образом, <span class="math notranslate nohighlight">\(\mf \Delta x\)</span> часто называют расстоянием между сетками.</p>
<p>Общим индексом для пространственно дискретизированных функций является</p>
<div class="math notranslate nohighlight">
\[
\mf f(x_i) = f_i\quad ,
\]</div>
<p>где индекс, указывающий положение на пространственной сетке, помещается в виде нижнего индекса.</p>
<p>Приведенные выше определения и следующие примеры относятся к одномерной системе. В общем случае моделирование пожара решается в трехмерной области с соответствующими величинами для y- и z-направлений, т.е. <span class="math notranslate nohighlight">\(\mf \Delta y, \Delta z\)</span>.</p>
<p><strong>Пример дискретизации:</strong> приведен  <span class="math notranslate nohighlight">\(\mf n_x = 20\)</span>, функция в уравнении <a class="reference internal" href="#equation-eq-cfd-example-fnk">(2.14)</a> принимает следующее дискретное представление.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xe</span> <span class="o">-</span> <span class="n">xb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>

<span class="n">fi</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;continuous $\sf f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">xi</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;discretised $\sf f(x_i)$&#39;</span><span class="p">)</span>
<span class="c1"># plt.vlines( xi, [0] * len(xi), fi, color=&#39;grey&#39;, alpha=0.3)</span>

<span class="c1"># строка при y=0</span>
<span class="c1"># plt.axhline(0, color=&#39;black&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/discretisation.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c97d0baf2c0244f2a9c9bd0f91799d407e13aa71dd06219b8ccf691e01f71d4b.svg" src="../../../_images/c97d0baf2c0244f2a9c9bd0f91799d407e13aa71dd06219b8ccf691e01f71d4b.svg" /><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-cfd-discretisation">
<a class="reference internal image-reference" href="../../../_images/discretisation.svg"><img alt="../../../_images/discretisation.svg" src="../../../_images/discretisation.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.16 </span><span class="caption-text">Одномерная дискретизация.</span><a class="headerlink" href="#fig-cfd-discretisation" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id7">
<h3>Дискретные производные<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Учитывая формулы аппроксимации и дискретизированную функцию, вычислить ее производную можно только с использованием ее значений. Формулы аппроксимации оцениваются с помощью <span class="math notranslate nohighlight">\(\mf h = \Delta x\)</span>.</p>
<p>Для функции, показанной выше, и использующей центральные разности второго порядка <code class="xref eq docutils literal notranslate"><span class="pre">eq-cfd-central-derivative-snd</span></code>, плюс направленные производные <a class="reference internal" href="#equation-eq-cfd-directional-derivative-snd">(2.20)</a> на границах, аппроксимированная производная показана на следующем рисунке.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># функция для вычисления первой производной с помощью</span>
<span class="c1"># с помощью схемы центрального дифференцирования</span>
<span class="k">def</span> <span class="nf">central</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># центральная схема дискретизации</span>
        <span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
       
   <span class="c1"># использование направленных производных на границе</span>
    <span class="n">yp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">[</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">yp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">yp</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># аналитическое решение производной для сравнения</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># аппроксимация производной</span>
<span class="n">fpi</span> <span class="o">=</span> <span class="n">central</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">fi</span><span class="p">)</span>

<span class="c1"># график функции</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact $\sf f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">xi</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;discretised $\sf f(x_i)$&#39;</span><span class="p">)</span>

<span class="c1"># график производной</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact $\sf f&#39;(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">xi</span><span class="p">,</span> <span class="n">fpi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;approximation $\sf f&#39;(x_i)$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="c1"># plt.ylim(ylim)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/discrete-derivative.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/508707bc06b908e5fe6047a76d13c60a2d83014dfbc16b7e7deca4afd99c3a63.svg" src="../../../_images/508707bc06b908e5fe6047a76d13c60a2d83014dfbc16b7e7deca4afd99c3a63.svg" /><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-cfd-discrete-derivative">
<a class="reference internal image-reference" href="../../../_images/discrete-derivative.svg"><img alt="../../../_images/discrete-derivative.svg" src="../../../_images/discrete-derivative.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.17 </span><span class="caption-text">Аппроксимация первой производной.</span><a class="headerlink" href="#fig-cfd-discrete-derivative" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition- admonition">
<p class="admonition-title">Задание</p>
<p>Создайте график, аналогичный <a class="reference internal" href="#fig-cfd-discrete-derivative"><span class="std std-numref">Fig. 2.17</span></a> для функции</p>
<div class="math notranslate nohighlight">
\[
\mf f(x) = x^4 + 3x^3 + 2 \quad .
\]</div>
<ol class="arabic simple">
<li><p>Дискретизируйте функцию с <span class="math notranslate nohighlight">\(\mf n_x = 20\)</span> между -2 и 4 и постройте график непрерывного и дискретного представления.</p></li>
<li><p>Используйте эту дискретизацию для аппроксимации первой производной. Постройте точную и аппроксимированную производнуюve.
1Проделайте то же самое для второй производной.e.</p></li>
</ol>
</div>
</section>
<section id="id8">
<h3>Ошибка аппроксимации<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>Если известна точная производная, то можно вычислить точное отклонение численного приближения от точных значений. Общим подходом к вычислению разницы между двумя наборами данных является L2-норма или среднеквадратичная ошибка (RMSE). Учитывая разницу значений функции <span class="math notranslate nohighlight">\(\mf \Delta f\)</span>, здесь</p>
<div class="math notranslate nohighlight">
\[
\mf \Delta f_i = f'_{numeric,i} - f'_{exact,i}
\]</div>
<p>в тех же местах <span class="math notranslate nohighlight">\(\mf x_i\)</span> with <span class="math notranslate nohighlight">\(\mf i \in [0, \dots, n_x-1]\)</span>, значение RMSE равно</p>
<div class="math notranslate nohighlight">
\[
\mf RMSE(\Delta f) = \sqrt{\frac{1}{n_x}\sum_{i=0}^{n_x-1}\left(\Delta f_i\right)^2}\quad .
\]</div>
<p>Для примера функции из предыдущего раздела ошибка аппроксимации может быть вычислена для различных значений <span class="math notranslate nohighlight">\(\mf \Delta x\)</span>, как показано на следующем рисунке. Как и ожидалось для схемы аппроксимации второго порядка, ошибка ведет себя аналогично квадратичной функции. Однако из-за конечного представления чисел с плавающей запятой сходимость прекращается, когда начинает преобладать ошибка округления.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dx_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rmse_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">nxe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">nxe</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xe</span> <span class="o">-</span> <span class="n">xb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>

    <span class="n">fi</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
    <span class="n">fpi</span> <span class="o">=</span> <span class="n">central</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">fi</span><span class="p">)</span>
    
    <span class="n">fp</span> <span class="o">=</span> <span class="n">fnk</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">fpi</span> <span class="o">-</span> <span class="n">fp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">nx</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dx=</span><span class="si">{</span><span class="n">dx</span><span class="si">:</span><span class="s2">4.2e</span><span class="si">}</span><span class="s2"> --&gt; rmse=</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">4.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">dx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">rmse_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dx=8.57e-01 --&gt; rmse=2.12e-01
dx=4.00e-01 --&gt; rmse=4.72e-02
dx=1.94e-01 --&gt; rmse=1.03e-02
dx=9.52e-02 --&gt; rmse=2.55e-03
dx=4.72e-02 --&gt; rmse=6.33e-04
dx=2.35e-02 --&gt; rmse=1.57e-04
dx=1.17e-02 --&gt; rmse=3.92e-05
dx=5.87e-03 --&gt; rmse=9.80e-06
dx=2.93e-03 --&gt; rmse=2.45e-06
dx=1.47e-03 --&gt; rmse=6.12e-07
dx=7.33e-04 --&gt; rmse=1.53e-07
dx=3.66e-04 --&gt; rmse=3.82e-08
dx=1.83e-04 --&gt; rmse=9.55e-09
dx=9.16e-05 --&gt; rmse=2.39e-09
dx=4.58e-05 --&gt; rmse=5.97e-10
dx=2.29e-05 --&gt; rmse=1.49e-10
dx=1.14e-05 --&gt; rmse=3.74e-11
dx=5.72e-06 --&gt; rmse=1.09e-11
dx=2.86e-06 --&gt; rmse=1.14e-11
dx=1.43e-06 --&gt; rmse=1.99e-11
dx=7.15e-07 --&gt; rmse=4.57e-11
dx=3.58e-07 --&gt; rmse=8.91e-11
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dx_list</span><span class="p">,</span> <span class="n">rmse_list</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dx_list</span><span class="p">,</span> <span class="n">rmse_list</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">dx_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dx_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dx_list</span><span class="p">,</span> <span class="n">dx_np</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sf \sim\Delta x^2$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\sf\Delta x$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\sf RMSE $&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./figs/approximation_error.svg&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fcb190b0d472c87ca5e61d5103046d81a42a50b8262f728feece4be77a5d9b34.svg" src="../../../_images/fcb190b0d472c87ca5e61d5103046d81a42a50b8262f728feece4be77a5d9b34.svg" /><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-cfd-approximation-error">
<a class="reference internal image-reference" href="../../../_images/approximation_error.svg"><img alt="../../../_images/approximation_error.svg" src="../../../_images/approximation_error.svg" width="90%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.18 </span><span class="caption-text">Погрешность аппроксимации в зависимости от расстояния между ячейками.</span><a class="headerlink" href="#fig-cfd-approximation-error" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition- admonition">
<p class="admonition-title">Задание</p>
<p>Почему ошибка аппроксимации не уменьшается в дальнейшем для <span class="math notranslate nohighlight">\(\mf \Delta x \lesssim 5\cdot 10^{-6}\)</span>? Примите во внимание уравнение <code class="xref eq docutils literal notranslate"><span class="pre">eq-cfd-central-derivative-snd</span></code> и ошибку округления для 64-разрядных чисел с плавающей запятой..</p>
</div>
</section>
</section>
<section id="id9">
<h2>Интегрирование по времени<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<section id="id10">
<h3>Траектории<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>Поскольку PDE, рассматриваемые в гидродинамике, часто содержат время как одно измерение, интеграция по времени является другим аспектом, помимо пространственных производных.</p>
<p>Аналогично пространственной дискретизации дискретизируется измерение времени. Таким образом, временной интервал <span class="math notranslate nohighlight">\(\mf [t_b=0, t_e]разделен наto \)</span>\mf n_tвременные этапыps:</p>
<div class="math notranslate nohighlight">
\[
\mf t_n = n\cdot\Delta t\quad with \quad \Delta t = \frac{t_e}{n_t-1} \quad and \quad n \in [0, n_t-1]\quad .
$$Для того, чтобы отличать временной индекс от пространственного, он помещается как надстрочный индекс и не должен быть смешан со степенямиrs:\]</div>
<p>\mf u(t_n) = u^n\quad .
$$</p>
<p>Дана производная функции по времени, т.е. правая часть (rhs),</p>
<div class="math notranslate nohighlight">
\[
\mf \partial_t u = \du = rhs(u, t)
\]</div>
<p>и начальное значение для <span class="math notranslate nohighlight">\(\mf u\)</span> на  <span class="math notranslate nohighlight">\(\mf t=0\)</span>, необходимо вычислить временную эволюцию, также называемую траекторией. Интегрирование по времени направлено на аппроксимацию следующего значения решения <span class="math notranslate nohighlight">\(\mf u^{n+1}\)</span>.</p>
<p>Ниже пункт оценки rhs сокращен до</p>
<div class="math notranslate nohighlight">
\[
\mf rhs(u(t_n), t_n) = rhs^n \quad .
\]</div>
</section>
<section id="id11">
<h3>Явный метод Эйлера<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>На основе, опять же, ряда Тейора, прямое приближение следующего значения решения основано на</p>
<div class="math notranslate nohighlight">
\[
\mf \frac{u^{n+1} - u^n}{\Delta t} = rhs^n + \mathcal{O}(\Delta t)\quad .
\]</div>
<p>Это ведет непосредственно к</p>
<div class="math notranslate nohighlight" id="equation-eq-cfd-time-forward-euler">
<span class="eqno">(2.22)<a class="headerlink" href="#equation-eq-cfd-time-forward-euler" title="Link to this equation">#</a></span>\[
\mf u^{n+1} = u^n + \Delta t \cdot rhs^n + \mathcal{O}(\Delta t)\quad .
\]</div>
<p>Уравнение  <a class="reference internal" href="#equation-eq-cfd-time-forward-euler">(2.22)</a> является явным / прямым методом Эйлера. Графически это продемонстрировано на  <a class="reference internal" href="#fig-fluid-time-explicit"><span class="std std-numref">Fig. 2.19</span></a>.</p>
<figure class="align-default" id="fig-fluid-time-explicit">
<a class="reference internal image-reference" href="../../../_images/time_integration_2_explicit.svg"><img alt="../../../_images/time_integration_2_explicit.svg" src="../../../_images/time_integration_2_explicit.svg" width="80%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.19 </span><span class="caption-text">Интегрирование по времени – явная схема Эйлера.</span><a class="headerlink" href="#fig-fluid-time-explicit" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id12">
<h3>Неявный метод Эйлера<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>Оценка производной в  <a class="reference internal" href="#equation-eq-cfd-time-forward-euler">(2.22)</a> при <span class="math notranslate nohighlight">\(\mf t_n\)</span> то только одна из возможностей. Тем же способом, что и пространственные производные по направлению, оценка может быть выполнена на <span class="math notranslate nohighlight">\(\mf t_{n+1}\)</span> и приводит к следующей итерационной формуле:</p>
<div class="math notranslate nohighlight" id="equation-eq-cfd-time-backward-euler">
<span class="eqno">(2.23)<a class="headerlink" href="#equation-eq-cfd-time-backward-euler" title="Link to this equation">#</a></span>\[
\mf u^{n+1} = u^n + \Delta t \cdot rhs^{n+1} + \mathcal{O}(\Delta t)\quad .
\]</div>
<p>Уравнение <a class="reference internal" href="#equation-eq-cfd-time-backward-euler">(2.23)</a> является неявным / обратным методом Эйлера. Графически это продемонстрировано на <a class="reference internal" href="#fig-fluid-time-implicit"><span class="std std-numref">Fig. 2.20</span></a>. Это неявный подход, в отличие от явной схемы Эйлера, который не позволяет напрямую вычислять следующий шаг итерации, основываясь только на решении текущих значений <span class="math notranslate nohighlight">\(\mf u^n\)</span>. Однако, поскольку <span class="math notranslate nohighlight">\(\mf rhs\)</span> может быть вычислен для любого значения <span class="math notranslate nohighlight">\(\mf u\)</span>, соответствующее значение <span class="math notranslate nohighlight">\(\mf u^{n+1}\)</span> можно найти, что они удовлетворяют уравнению  <a class="reference internal" href="#equation-eq-cfd-time-backward-euler">(2.23)</a>.</p>
<figure class="align-default" id="fig-fluid-time-implicit">
<a class="reference internal image-reference" href="../../../_images/time_integration_3_implicit.svg"><img alt="../../../_images/time_integration_3_implicit.svg" src="../../../_images/time_integration_3_implicit.svg" width="80%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.20 </span><span class="caption-text">Интегрирование по времени – неявная схема Эйлера.</span><a class="headerlink" href="#fig-fluid-time-implicit" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id13">
<h3>Метод Эйлера-Хойна<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>Метод Эйлера-Хойна иллюстрирует схему интегрирования по времени второго порядка.</p>
<p>Сначала выполняется явное предсказание</p>
<div class="math notranslate nohighlight">
\[
\mf u_p^{n+1} = u^n + \Delta t\cdot rhs^n\quad .
\]</div>
<p>Это промежуточное решение используется для скорректированной аппроксимации</p>
<div class="math notranslate nohighlight">
\[
\mf u^{n+1} = u^n + \frac{1}{2} \Delta t\cdot \left(rhs^n + rhs(u_p^{n+1}) \right) + \mathcal{O}(\Delta t^2)\quad .
\]</div>
<figure class="align-default" id="fig-fluid-time-predictorcorrector">
<a class="reference internal image-reference" href="../../../_images/time_integration_5_predictorcorrector.svg"><img alt="../../../_images/time_integration_5_predictorcorrector.svg" src="../../../_images/time_integration_5_predictorcorrector.svg" width="80%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.21 </span><span class="caption-text">Интегрирование по времени – схема предсказателя-корректора Эйлера-Хойна.</span><a class="headerlink" href="#fig-fluid-time-predictorcorrector" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id14">
<h3>Методы Рунге-Кутты<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>Существует широкий спектр схем интегрирования по времени. Одним из классов из них являются <a class="reference external" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">методы Рунге-Кутты</a>. Классической схемой является следующий метод четвертого порядка:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align} 
\mf u^{(1)} &amp;=\mf u^n + \frac{1}{2}\Delta t\cdot rhs^n \\ 
\mf u^{(2)} &amp;=\mf u^n + \frac{1}{2}\Delta t\cdot rhs\left(u^{(1)}\right) \\ 
\mf u^{(3)} &amp;=\mf u^n + \Delta t\cdot rhs\left(u^{(2)}\right) \\ 
\mf u^{n+1} &amp;=\mf u^n + \frac{1}{6}\Delta t\cdot \left(rhs^n + 2\ rhs\left(u^{(1)}\right) + 2\ rhs\left(u^{(2)}\right) + rhs\left(u^{(3)}\right)\right) + \mathcal{O}(\Delta t^4) \quad .
\end{align}
\end{split}\]</div>
</section>
</section>
<section id="id15">
<h2>Метод конечных разностей<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<section id="id16">
<h3>Подход к решению<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<p>Рассмотрим простое уравнение диффузии:</p>
<div class="math notranslate nohighlight">
\[
\mf \partial_t \phi = \lambda\partial_{xx} \phi
\]</div>
<p><strong>Форвард Эйлер:</strong> Эта схема может быть оценена непосредственно – явно.</p>
<div class="math notranslate nohighlight">
\[
\mf \frac{\phi^{n+1}_i - \phi^n_i}{\Delta t} = \lambda\frac{\phi^n_{i-1} - 2\phi_i^n + \phi_{i+1}^n}{\Delta x^2}
\]</div>
<div class="math notranslate nohighlight">
\[
\mf \phi^{n+1}_i = \phi^n_i + \Delta t \lambda \frac{\phi^n_{i-1} - 2\phi_i^n + \phi_{i+1}^n}{\Delta x^2}
\]</div>
<figure class="align-default" id="fig-fdm-explicit-euler">
<a class="reference internal image-reference" href="../../../_images/fdm_explicit_euler.png"><img alt="../../../_images/fdm_explicit_euler.png" src="../../../_images/fdm_explicit_euler.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.22 </span><span class="caption-text">Явная схема Эйлера.</span><a class="headerlink" href="#fig-fdm-explicit-euler" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Обратный Эйлер:</strong> здесь система линейных уравнений должна быть решена для <span class="math notranslate nohighlight">\(\phi^{n+1}\)</span>.”</p>
<div class="math notranslate nohighlight">
\[
\mf \frac{\phi^{n+1}_i - \phi^n_i}{\Delta t} = \lambda \frac{\phi^{n+1}_{i-1} - 2\phi_i^{n+1} + \phi_{i+1}^{n+1}}{\Delta x^2}
\]</div>
<div class="math notranslate nohighlight">
\[
\mf \phi^{n+1}_i - \frac{\Delta t}{\Delta x^2}\lambda\left( \phi^{n+1}_{i-1} - 2\phi_i^{n+1} + \phi_{i+1}^{n+1} \right) = \phi^n_i
\]</div>
<div class="math notranslate nohighlight">
\[
\mf A\phi^{n+1} = \phi^n
\]</div>
<figure class="align-default" id="fig-fdm-implicit-euler">
<a class="reference internal image-reference" href="../../../_images/fdm_implicit_euler.png"><img alt="../../../_images/fdm_implicit_euler.png" src="../../../_images/fdm_implicit_euler.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.23 </span><span class="caption-text">Неявная схема Эйлера.</span><a class="headerlink" href="#fig-fdm-implicit-euler" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id17">
<h2>Устойчивость<a class="headerlink" href="#id17" title="Link to this heading">#</a></h2>
<section id="id18">
<h3>Распространение информации<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<p>Важным свойством временного интегратора является его стабильность. Учитывая решаемую PDE и временной интегратор, можно провести простой (линейный) анализ устойчивости, например анализ устойчивости по фон Нейману. Результатом является коэффициент роста, который указывает на скорость роста малых возмущений. Если этот коэффициент больше 1, то схема нестабильна, поскольку колебания будут бесконечно возрастать.</p>
<ul class="simple">
<li><p>Явные схемы, как правило, нестабильны или условно устойчивы, т.е. если выполняется условие для временного шага</p></li>
<li><p>Неявные схемы, как правило, безусловно стабильны, однако они имеют тенденцию ослаблять решение
Задача адвекции с постоянной скоростью демонстрирует условие устойчивостиon.</p></li>
</ul>
<p>Низкая скорость распространенияed**</p>
<p>Модельное уравнение
on</p>
<div class="math notranslate nohighlight">
\[
  \mf \partial_t \phi + \partial_x(v_0\phi) = 0
  $Небольшой mall $\mf \Delta t$Пройденное расстояние за 
per $\mf \Delta t$:
  
  \]</div>
<p>\mf \delta x = v_0 \Delta t \lt \Delta x
Информация перемещается меньше, чем then <span class="math notranslate nohighlight">\(\mf\Deltс шагом по времени step \)</span>\mf\Deltи фиксируется соседней точкой сетки
pИнформация о решении не теряется во время интегрирования по времениgration</p>
</section>
<section id="cfl">
<h3>Условие Куранта-Фридрихса-Леви (CFL)<a class="headerlink" href="#cfl" title="Link to this heading">#</a></h3>
<p>В общем случае существуют условия устойчивости для явных схем, которые соотносят максимальную скорость распространения информации <span class="math notranslate nohighlight">\(\mf v_{max}\)</span> и скорость сетки <span class="math notranslate nohighlight">\(\mf v_g = \Delta x / \Delta t\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mf v_{max} \lt CFL\cdot v_{g}\quad .
\]</div>
<p>Учитывая сетчатое разрешение <span class="math notranslate nohighlight">\(\mf\Delta x\)</span> вышеуказанное условие ограничивает временной шаг при максимальных скоростях:</p>
<div class="math notranslate nohighlight">
\[
\mf \Delta t \lt CFL\cdot \frac{\Delta x}{v_{max}}
$$Примечанияes:
Скорость потока может быть вычислена различными способамиys ($\mf L_\infty$, $L_1$, $L_2нормыms)скорость диффузииty $\mf \propto 1/\Delta x$
Существуют и другие ограничения наon $\mf Delta t$ограничение массовой плотности и объемаnt.
Значение числа CFL зависит от схемы интегрирования по времениme.Последствия состояния CFL в FDS:
Условие для   for $\mf \Deltв FDS используетсяDS is\]</div>
<p>\mf 0.8 \leq CFL = \Delta t \left(\frac{|\vec{v}|}{\Delta x} + |\nabla \cdot \vec{v}|\right) \leq 1.0
$Если число CFL растет выше верхнего предела, временной шаг устанавливается равным 90% от допустимого, если оно падает ниже нижнего предела, то его увеличивают на 10%. 10Как правило, временной шаг сокращается в 2 раза, когда расстояние между ячейками уменьшается в 2 раза, т. е. общая вычислительная нагрузка увеличивается в 16 раз.f 16.</p>
</section>
<section id="id19">
<h3>Дополнительная заметка о том, как выполнялись вычисления в прошлом<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>Краткий раздел из презентации Ричарда Фейнмана “Лос-Аламос снизу”. Он описывает, как отдельные люди выполняли численные вычисления для каждого узла сетки и типа вычислений.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/uY-u1qyRM5w?start=2804" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/modelling/02_fluids"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_fluids.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.1. </span>Жидкости и газы</p>
      </div>
    </a>
    <a class="right-next"
       href="03_turbulence.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.3. </span>Turbulence</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Обзор</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Аппроксимация производных</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Ряд Тейлора</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Производные</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Дискретизация</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Дискретные производные</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Ошибка аппроксимации</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Интегрирование по времени</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Траектории</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Явный метод Эйлера</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Неявный метод Эйлера</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Метод Эйлера-Хойна</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Методы Рунге-Кутты</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Метод конечных разностей</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Подход к решению</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Устойчивость</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Распространение информации</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cfl">Условие Куранта-Фридрихса-Леви (CFL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Дополнительная заметка о том, как выполнялись вычисления в прошлом</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
<img src='https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg' height='31'/>
| By Team Fire | Contacts and Infos: <a href='https://cce.uni-wuppertal.de/en.html'>CCE@BUW</a> and <a href='https://www.fz-juelich.de/ias/ias-7/EN/Research/Fire_Dynamics/_node.html'>IAS-7@FZJ</a>
</br>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>